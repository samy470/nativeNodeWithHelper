<!DOCTYPE html>
<html>

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container mt-3">

  <h1 class="mb-3">Users API</h1>

  <!-- Users List -->
  <div class="mb-3">
    <h4>Users</h4>
    {{#each users}}
    <div class="badge bg-secondary m-1">{{this.id}}: {{this.email}}, {{this.name}}</div>
    <!-- Update User -->
    <form action="/users/update" method="post" style="display: inline;">

      <input hidden="true" name="id" value="{{this.id}}">
      <input type="email" name="email" class="form-control mb-2" placeholder="New Email" style="display: none;">
      <input type="text" name="name" class="form-control mb-2" placeholder="New Name" style="display: none;">
      <button type="button" onclick="showInputs(this)" class="btn btn-sm btn-primary">Update</button>
      <button type="submit" onclick="hideInputs(this)" style="display: none;"
        class="btn btn-sm btn-success">Save</button>
    </form>

    <!-- Delete User -->
    <form action="/users/delete" method="post" style="display: inline;">
      <input hidden="true" name="id" value="{{this.id}}">
      <button type="submit" class="btn btn-sm btn-danger">Delete</button>
    </form>
    {{/each}}
  </div>
  <h4 class="mb-3">Add new users</h4>
  <!-- Add User -->
  <form action="/users" method="post">
    <input name="email" class="form-control mb-2" placeholder="Email">
    <input name="name" class="form-control mb-2" placeholder="Name">
    <button type="submit" class="btn btn-sm btn-success">Add</button>
  </form>


  <!-- Results -->
  <div id="result" class="alert alert-info" style="display: none;"></div>
</body>
<script>
  function showInputs(button) {
    const form = button.closest('form');
    form.querySelector('input[name="email"]').style.display = 'block';
    form.querySelector('input[name="name"]').style.display = 'block';
    form.querySelector('button[type="submit"]').style.display = 'inline-block';
    form.querySelector('button[type="button"]').style.display = 'none';
  }

  function hideInputs(button) {
    const form = button.closest('form');
    form.querySelector('input[name="email"]').style.display = 'none';
    form.querySelector('input[name="name"]').style.display = 'none';
    form.querySelector('button[type="submit"]').style.display = 'none';
    form.querySelector('button[type="button"]').style.display = 'inline-block';

    return true;
  }
</script>

</html>